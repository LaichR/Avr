<?xml version="1.0" encoding="utf-8"?>
<Unit xmlns ="http://tempuri.org/EntityDescription.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://tempuri.org/EntityDescription.xsd ./EntityDescription.xsd"
      Name="PredefinedTypes" Namespace="Types">
  <Import LibraryOrFile="PredefinedTypes.xml" ByReference="true" />

  <TypeDefinition Name="SMCR_T" xsi:type="IntegerType" Signed="false" Size="1">
    <Description>Sleep mode control register</Description>
    <Bitfield Name="SE" Position="0" Width="1">
      <Description>Sleep enable</Description>
    </Bitfield>
    <Bitfield Name="SM" Position="1" Width="3">
      <Description>Sleep mode</Description>
      <ValueSet Name="SleepMode">
        <Enum Name="Idle" Value="0"/>
        <Enum Name="AdcNoiseRed" Value="1"/>
        <Enum Name="PowerDown" Value="2"/>
        <Enum Name="PowerSave" Value="3"/>
        <Enum Name="StandBy" Value="6"/>
        <Enum Name="ExtStandBy" Value="7"/>

      </ValueSet>
    </Bitfield>
  </TypeDefinition>

  <TypeDefinition Name="MCUCR_T" xsi:type="IntegerType" Size="1" Signed="false">
    <Description>MCU control register</Description>
    <Bitfield Name="IVCE" Position="0" Width="1"/>
    <Bitfield Name="IVSEL" Position="1" Width="1"/>
    <Bitfield Name="PUD" Position="4" Width="1">
      <Description>Pull up disable</Description>
    </Bitfield>
    <Bitfield Name="BODSE" Position="5" Width="1"></Bitfield>
    <Bitfield Name="BODS" Position="6" Width="1"></Bitfield>
  </TypeDefinition>

  <TypeDefinition Name ="GPIO_T" xsi:type="StructType">
    <Description>
    </Description>
    <TypeDefinition Name="PIN_T" xsi:type="IntegerType" Size="1" Signed="false">
      <Description>Bitmaps for port pins</Description>
      <Bitfield Name="0" Width ="1" Position ="0">
        <Default>0</Default>
      </Bitfield>
      <Bitfield Name="_1" Width ="1" Position ="1">
        <Default>0</Default>
      </Bitfield>
      <Bitfield Name="_2" Width ="1" Position ="2">
        <Default>0</Default>
      </Bitfield>
      <Bitfield Name="_3" Width ="1" Position ="3">
        <Default>0</Default>
      </Bitfield>
      <Bitfield Name="_4" Width ="1" Position ="4">
        <Default>0</Default>
      </Bitfield>
      <Bitfield Name="_5" Width ="1" Position ="5">
        <Default>0</Default>
      </Bitfield>
      <Bitfield Name="_6" Width ="1" Position ="6">
        <Default>0</Default>
      </Bitfield>
      <Bitfield Name="_7" Width ="1" Position ="7">
        <Default>0</Default>
      </Bitfield>
    </TypeDefinition>

    <Field Name="PIN" FieldType="PIN_T" Aligned="1"/>
    <Field Name="DDR" FieldType="PIN_T" Aligned="1"/>
    <Field Name="PORT" FieldType="PIN_T" Aligned="1"/>
  </TypeDefinition>

  <TypeDefinition Name="TCNT8_T" xsi:type="StructType">
    <Description>8 bit timer counter
    </Description>
    <TypeDefinition Name="TCCRA_T" xsi:type="IntegerType" Size="1" Signed="false">
      <Bitfield Name="WGM" Position="0" Width="2">
        <Description>
        Waveform generation mode:
          0 = Normal
          1 = PWM, normal mode
          2 = CTC (clear timer on compare match)
          3 = Fast PWM
        </Description>
      </Bitfield>
      <Bitfield Name="COMB" Position="4" Width="2">
        <Description>Compare output mode; depending on the setting in WGM COMB has a different meaning</Description>
      </Bitfield>
      <Bitfield Name="COMA" Position="6" Width="2">
        <Description>Defines behavior of OCA on a compare match</Description>
      </Bitfield>
    </TypeDefinition>
    <TypeDefinition Name="TCCRB_T" xsi:type="IntegerType" Signed="false" Size="1">
      <Bitfield Name="CS" Position="0" Width="3">
        <Description>Clock selection
        0 = off
        1 = no prescaler
        2 = clk-IO / 8
        3 = clk-IO / 64
        4 = clk-IO / 256
        5 = clk-IO / 1024
        6 = external clock source on T0 pin; clock on falling edge
        7 = external clock source on T0 pin; clock on rising edge
        </Description>
      </Bitfield>

      <Bitfield Name="WGM" Position="3" Width="1">
        <Description>Select PWM mode if set to 1</Description>
      </Bitfield>
      <Bitfield Name="Reserved" Position="4" Width="2"/>
      <Bitfield Name="FOCB" Position="6" Width="1">
        <Description>Force output compare on OCRB; takes effect if WGM bit not set to 1</Description>
      </Bitfield>
      <Bitfield Name="FOCA" Position="7" Width="1">
        <Description>Force output compare on OCRA; takes effect if WGM bit not set to 1</Description>
      </Bitfield>
    </TypeDefinition>
    <Field Name="TCCRA" FieldType="TCCRA_T" Aligned="1"></Field>
    <Field Name="TCCRB" FieldType="TCCRB_T" Aligned="1"></Field>
    <Field Name="TCNT" FieldType="uint8_t" Aligned="1"></Field>
    <Field Name="OCRA" FieldType="uint8_t" Aligned="1"></Field>
    <Field Name="OCRB" FieldType="uint8_t" Aligned="1"></Field>
  </TypeDefinition>

  <TypeDefinition Name="TIFR_T" xsi:type="IntegerType" Size="1" Signed="false">
    <Bitfield Name="TOV" Position="0" Width="1">
      <Description>Timer overvlow occurred</Description>
    </Bitfield>
    <Bitfield Name="OCFA" Position="1" Width="1">
      <Description>Timer output compare match occured with register OCRA</Description>
    </Bitfield>
    <Bitfield Name="OCFB" Position="2" Width="1">
      <Description>Timer output compare match occured register OCRB</Description>
    </Bitfield>
    <Bitfield Name="ICF" Position="5" Width="1">
      <Description>Input capture flag</Description>
    </Bitfield>
  </TypeDefinition>


  <TypeDefinition Name="USART_T" xsi:type="StructType">
    <TypeDefinition Name="USRA_T" xsi:type="IntegerType" Signed="false" Size="1">
      <Description>Status and configuration register A</Description>
      <Bitfield Name="RXC" Position="7" Width="1">
        <Description>Receive complete flag</Description>
        <Access>ReadOnly</Access>
      </Bitfield>
      <Bitfield Name="TXC" Position="6" Width="1">
        <Description>Transmit complete</Description>
      </Bitfield>
      <Bitfield Name="UDRE" Position="5" Width="1">
        <Description>Indicates that transmit buffer is empty</Description>
        <Access>ReadOnly</Access>
      </Bitfield>
      <Bitfield Name="FE" Position="4" Width="1">
        <Description>Indicates that a frame error occurred</Description>
        <Access>ReadOnly</Access>
      </Bitfield>
      <Bitfield Name="DOR" Position="3" Width="1">
        <Description>Indicates that a data overrun error occurred</Description>
        <Access>ReadOnly</Access>
      </Bitfield>
      <Bitfield Name="UPE" Position="2" Width="1">
        <Description>Indicates that a parity error occurred</Description>
        <Access>ReadOnly</Access>
      </Bitfield>
      <Bitfield Name="U2X" Position="1" Width="1">
        <Description>Enable double transmission speed in asynchronous mode</Description>
      </Bitfield>
      <Bitfield Name="MPCM" Position="1" Width="1">
        <Description>Multi-processor communication mode</Description>
      </Bitfield>
    </TypeDefinition>
    <TypeDefinition Name="USRB_T" xsi:type="IntegerType" Signed="false" Size="1">
      <Description>Status and configuration register B</Description>
      <Bitfield Name="TXB8" Position="0" Width="1">
        <Description>Ninth databit to transmit if data frame size = 9</Description>
      </Bitfield>
      <Bitfield Name="RXB8" Position="1" Width="1">
        <Description>Ninth databit to receive if data frame size = 9</Description>
      </Bitfield>
      <Bitfield Name="UCSZ2" Position="2" Width="1">
        <Description>enable 9 bit character size; UCSZ01 needs to have value 3</Description>
      </Bitfield>
      <Bitfield Name="TXEN" Position="3" Width="1">
        <Description>Enable transmitter</Description>
      </Bitfield>
      <Bitfield Name="RXEN" Position="4" Width="1">
        <Description>Enable receiver</Description>
      </Bitfield>
      <Bitfield Name="UDRIEN" Position="5" Width="1">
        <Description>Enable data register empty interrupt</Description>
      </Bitfield>
      <Bitfield Name="TXCIEN" Position="6" Width="1">
        <Description>Transmit complete interrupt</Description>
      </Bitfield>
      <Bitfield Name="RXCIEN" Position="7" Width="1">
        <Description>Enable receive complete interrupt
        </Description>
      </Bitfield>
    </TypeDefinition>
    <TypeDefinition Name="USRC_T" xsi:type="IntegerType" Signed="false" Size="1">
      <Description>Status and configuration register C
      </Description>
      <Bitfield Name="UCPOL" Position="0" Width="1">
        <Description>Clock polarity</Description>
      </Bitfield>
      <Bitfield Name="UCSZ01" Position="1" Width="2">
        <Description>Low bits of data frame size</Description>
      </Bitfield>
      <Bitfield Name="USBS" Position="3" Width="1">
        <Description>Stop bit select</Description>
      </Bitfield>
      <Bitfield Name="UPM" Position="4" Width="2">
        <Description>Parity check configuration</Description>
        <ValueSet Name="UART_ParityMode">
          <Enum Name="NoParityCheck" Value="0"/>
          <Enum Name="EvenParity" Value="2" />
          <Enum Name="OddParity" Value="3" />
        </ValueSet>
      </Bitfield>
      <Bitfield Name="UMSEL" Position="6" Width="2">
        <Description>Uart mode select</Description>
        <ValueSet Name="UART_ModeSelect">
          <Enum Name="Asynchronous" Value="0"/>
          <Enum Name="Synchronous" Value="1"/>
          <Enum Name="SpiMaster" Value="3"/>
        </ValueSet>
      </Bitfield>
    </TypeDefinition>
    <TypeDefinition Name ="UBBR_T" xsi:type="IntegerType" Signed="false" Size="2">
      <Bitfield Name="UBRR" Position="0" Width="12">
        <Description>Baud rate configuration register</Description>
      </Bitfield>
    </TypeDefinition>
    <Field Name="UCSRA" FieldType="USRA_T"></Field>
    <Field Name="UCSRB" FieldType="USRB_T"></Field>
    <Field Name="UCSRC" FieldType="USRC_T"></Field>
    <Field Name="Reserved" Aligned="1" FieldType="uint8_t"/>
    <Field Name="UBBR" Aligned="1" FieldType="UBBR_T"></Field>
    <Field Name="UDR" Aligned="1" FieldType="uint8_t">
      <Description>Data input output register</Description>
    </Field>
  </TypeDefinition>

  <MemorySection Name="IOMEM" Address="0x20" ByteOrder="LittleEndian" Chip="M328">
    <Symbol Name="PORTA" Offset="0" Type="GPIO_T">
      <Description>GPIO port A registers</Description>
    </Symbol>

    <Symbol Name="PORTB" Offset="3" Type="GPIO_T">
      <Description>GPIO port B registers</Description>
    </Symbol>

    <Symbol Name="PORTC" Offset="6" Type="GPIO_T">
      <Description>GPIO port C registers</Description>
    </Symbol>

    <Symbol Name="PORTD" Offset="9" Type="GPIO_T">
      <Description>GPIO port D registers</Description>
    </Symbol>

    <Symbol Name="TIFR" Offset="0x15" Type="TIFR_T">
      <Description>Timer interrupt flags</Description>
    </Symbol>

    <Symbol Name="TCNT0" Offset="0x24" Type="TCNT8_T">
      <Description>8 bit timer counter instance 0</Description>
    </Symbol>

    <Symbol Name="SMCR" Offset="0x33" Type ="SMCR_T">
      <Description>Sleep mode control register</Description>
    </Symbol>

    <Symbol Name="MCUCR" Offset="0x35" Type ="MCUCR_T">
      <Description>Sleep mode control register</Description>
    </Symbol>

    <Symbol Name="TCNT2" Offset="0x90" Type="TCNT8_T">
      <Description>8 bit timer counter instance 2</Description>
    </Symbol>

    <Symbol Name="USART" Offset="0xA0" Type="USART_T">
      <Description>Serial communication interface</Description>
    </Symbol>
  </MemorySection>

</Unit>
