<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AvrLib: C:/Users/rolfl/github/Avr/AvrLib/AvrLib.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AvrLib
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/d09/_avr_lib_8c_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AvrLib.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dc/d09/_avr_lib_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#ifndef __AVR_ATmega328P__</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#define __AVR_ATmega328P__</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !1</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;avr/io.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d1/d99/_atmega328_p_8h.html">Atmega328P.h</a>&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;avr/interrupt.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d9/dcd/_avr_lib_8h.html">AvrLib.h</a>&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d2/d7f/_register_access_8h.html">RegisterAccess.h</a>&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a43bafb28b29491ec7f871319b5a3b2f8">   23</a></span>&#160;<span class="preprocessor">#define F_CPU 16000000</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;util/delay.h&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/*                global variables                                        */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a70c39f26249a6aa73d608f47e34fe346">IsrHandler</a> _extIntHandler[2] = { 0,0 };</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a70c39f26249a6aa73d608f47e34fe346">IsrHandler</a> _compareMatchHandler[4] = { 0,0,0,0 };</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a915c5dd805b9fe49be4ca3fcd55b5e31">   36</a></span>&#160;<a class="code" href="../../df/d89/struct_fsm__tag.html">Fsm</a> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a915c5dd805b9fe49be4ca3fcd55b5e31">TestHandler</a> = { .<a class="code" href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Next</a> = 0, .<a class="code" href="../../df/d89/struct_fsm__tag.html#ab7668ff9f0f7f2a6cb9ed24f7f0a905b">RxMask</a> = 1, .CurrentState = 0 };</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">static</span> uint8_t _enterAtomicNesting = 0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a> _withinIsr = <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#ac0999c0821d14cfab43e6f3c778c2b95">   42</a></span>&#160;<span class="preprocessor">#define USART_RX_BUFFER_SIZE 32</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a21d527450b438bba8dab02e03f021ee3">   43</a></span>&#160;<span class="preprocessor">#define USART_TX_BUFFER_SIZE 32</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">static</span> uint8_t USART_rxBuffer[<a class="code" href="../../dc/d09/_avr_lib_8c.html#ac0999c0821d14cfab43e6f3c778c2b95">USART_RX_BUFFER_SIZE</a>];</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">static</span> uint8_t USART_txBuffer[<a class="code" href="../../dc/d09/_avr_lib_8c.html#a21d527450b438bba8dab02e03f021ee3">USART_TX_BUFFER_SIZE</a>];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a6fed9d9c8d3db2b0bfed3ae69b914827">   48</a></span>&#160;<span class="preprocessor">#define FilledTxEntries() (((USART_txBufferIn + USART_TX_BUFFER_SIZE) - USART_txBufferOut)%USART_TX_BUFFER_SIZE)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">static</span> <span class="keyword">volatile</span> uint8_t USART_rxBufferIn = 0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">static</span> <span class="keyword">volatile</span> uint8_t USART_rxBufferOut = 0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">static</span> <span class="keyword">volatile</span> uint8_t USART_txBufferIn = 0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">static</span> <span class="keyword">volatile</span> uint8_t USART_txBufferOut = 0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d5/d8e/struct_avr_message__tag.html">AvrMessage</a> _avrMessagePool[8];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">static</span> uint8_t    _avrMsgIndex[8] = { 0, 1, 2, 3, 4, 5, 6, 7};</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">static</span> uint8_t    _avrPoolIn = <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(_avrMessagePool) - 1;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">static</span> uint8_t    _avrPoolOut = 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../dd/d22/struct_cmd_write_reg.html">   61</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../dd/d22/struct_cmd_write_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">   63</a></span>&#160;    uint16_t <a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">adress</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../dd/d22/struct_cmd_write_reg.html#a5723e60ffd628510c699eddbce90be23">   64</a></span>&#160;    uint8_t <a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a5723e60ffd628510c699eddbce90be23">len</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">union</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../dd/d22/struct_cmd_write_reg.html#a96f44d20f1dbf1c8785a7bc99a46164c">   67</a></span>&#160;        uint8_t <a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a96f44d20f1dbf1c8785a7bc99a46164c">byte</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="../../dd/d22/struct_cmd_write_reg.html#af9036114e498c9fcb670232e4227341a">   68</a></span>&#160;        uint16_t <a class="code" href="../../dd/d22/struct_cmd_write_reg.html#af9036114e498c9fcb670232e4227341a">word</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../dd/d22/struct_cmd_write_reg.html#a582f3f7dde5c677ef7b3c6fc7d27beb4">   69</a></span>&#160;    }data;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}<a class="code" href="../../dd/d22/struct_cmd_write_reg.html">CmdWriteReg</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../d0/d70/struct_cmd_read_reg.html">   72</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d0/d70/struct_cmd_read_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">   74</a></span>&#160;    uint16_t <a class="code" href="../../d0/d70/struct_cmd_read_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">adress</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d0/d70/struct_cmd_read_reg.html#a5723e60ffd628510c699eddbce90be23">   75</a></span>&#160;    uint8_t <a class="code" href="../../d0/d70/struct_cmd_read_reg.html#a5723e60ffd628510c699eddbce90be23">len</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}<a class="code" href="../../d0/d70/struct_cmd_read_reg.html">CmdReadReg</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keyword">static</span> uint32_t _timerUs;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d89/struct_fsm__tag.html">Fsm</a> _anchor = { .<a class="code" href="../../df/d89/struct_fsm__tag.html#a60c28f55103a33bcb3962fc3c5c3108d">CurrentState</a> = 0, .Next = &amp;_anchor , .<a class="code" href="../../df/d89/struct_fsm__tag.html#ab7668ff9f0f7f2a6cb9ed24f7f0a905b">RxMask</a> = 0 };</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a> _messagePool[32];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a> _root = { .<a class="code" href="../../d3/d6f/struct_message__tag.html#a2e0462cee9727c48ffba3fe0d02e6395">Priority</a> = 16, .__next = &amp;_root };</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">static</span> uint8_t _messagePoolIndex[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(_messagePool)] =</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    0,1,2,3,4,5,6,7,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    8,9,10,11,12,13,14,15,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    16,17,18,19,20,21,22,23,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    24, 25, 26, 27, 28,29,30,31</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;};</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">static</span> uint8_t _qIn = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">static</span> uint8_t _qOut = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#add0902722b85415d9271d54289b2af87">SendMessage</a>(uint8_t prio, uint8_t <span class="keywordtype">id</span>, uint8_t msgLow, uint8_t msgHigh);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a4e2c9921140ec91965eb41df4f2e79f3">GetMessage</a>(<a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>* msg);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a7b883ddec9db2ef9aff1d336b0b4be3b">AvrMessageHandler</a> HandleAvrMessage = <a class="code" href="../../dc/d09/_avr_lib_8c.html#a0e58fe56e60a05f16b28a549f5fdae51">DefaultMessageHandler</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">/*                private functions                                       */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a4a93759a841d46df0a83cb7fee321783">HandleMessage</a>(<span class="keywordtype">char</span> receivedData);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a5778a2c9bd3532f9063233f1ae571771">ProcessMessage</a>(uint8_t msgType, uint8_t* msg, uint8_t msgLen);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(uint16_t value);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">/*                function implementations                                */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a81a5f6d0fbdccf837ea80a52da409049">  120</a></span>&#160;uint16_t <a class="code" href="../../dc/d09/_avr_lib_8c.html#a81a5f6d0fbdccf837ea80a52da409049">MeasureOnce</a>(<a class="code" href="../../d1/d99/_atmega328_p_8h.html#aced27cb9f5de7573f7ef7c25909b3084">AnalogChannelSelection</a> channel, <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a4ac9a19089919bbb987c7d53d373465c">ReferenceSelection</a> Vref, <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a5fdf9101a55da8ca267845a362e3d1ef">AdcPrescaler</a> prescaler)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a>.Adcsrb = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (channel &lt; 6)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a>.Didr0 = 1 &lt;&lt; channel;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="../../d2/d7f/_register_access_8h.html#af8f11a685f46bcd86b727c651674209d">SetRegister</a>( <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a>.Admux, (ADMUX_MUX, channel), (ADMUX_REFS,Vref));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="../../d2/d7f/_register_access_8h.html#af8f11a685f46bcd86b727c651674209d">SetRegister</a>(<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a>.Adcsra, (ADCSRA_ADEN, 1), (ADCSRA_ADSC, 1), (ADCSRA_ADPS, prescaler));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a>.Adcsra &amp; <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a29e45ee79c975841f5fed67d19101c43">ADCSRA_ADSC_mask</a>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a>.Didr0 = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a>.Data;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a689c8adc347f1499e90f601a55975c8d">  139</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a689c8adc347f1499e90f601a55975c8d">RegisterExternalInteruptHandler</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601">ExtInteruptSource</a> source,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4c0d7aa7c14c0567c522c664cd4e0b42">ExtIntTrigger</a> trigger, <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a70c39f26249a6aa73d608f47e34fe346">IsrHandler</a> handler)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;{</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a7502590be27d44096272c31c1798dd16">Eicra</a> |= ((trigger&amp;0xF) &lt;&lt; source);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    _extIntHandler[source] = handler;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#aa1e71c1b0af3b85ba60ee6afc8ab5455">Eimsk</a> |= (1 &lt;&lt; source);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#ad294b58ea2c279e31c0dde21101a5c83">  152</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#ad294b58ea2c279e31c0dde21101a5c83">UnregisterExternalInterruptHandler</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601">ExtInteruptSource</a> source)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#aa1e71c1b0af3b85ba60ee6afc8ab5455">Eimsk</a> &amp;= ~(1 &lt;&lt; source);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    _extIntHandler[source] = 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#abab4c4585c5bc06434241babc8460e7b">  164</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#abab4c4585c5bc06434241babc8460e7b">SetExtInterruptEnable</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601">ExtInteruptSource</a> source, <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a> enable)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (_extIntHandler != 0)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        uint8_t mask = (1 &lt;&lt; source);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        uint8_t val = <a class="code" href="../../d1/d99/_atmega328_p_8h.html#aa1e71c1b0af3b85ba60ee6afc8ab5455">Eimsk</a>|mask;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">if</span> (!enable)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            mask = ~mask;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            val &amp;= mask;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="../../d1/d99/_atmega328_p_8h.html#aa1e71c1b0af3b85ba60ee6afc8ab5455">Eimsk</a> = val;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t source1Div[] = { 1,2,3,4,5 };</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> uint8_t source2Div[] = { 1,2,4,6,7 };</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#aae6299783f51d753125be1a8c2d830be">  194</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#aae6299783f51d753125be1a8c2d830be">RegisterCompareMatchInterrupt</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6">CompareMatchSource</a> source,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="../../d9/dcd/_avr_lib_8h.html#aa3faf8a487b0f96253c1f91b127fe692">TimerFrequency</a> frequency, uint8_t match, <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a70c39f26249a6aa73d608f47e34fe346">IsrHandler</a> handler)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">volatile</span> <a class="code" href="../../d9/d52/struct_t_c_n_t8___t__tag.html">TCNT8_T</a> *timer = &amp;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a867aef8dd8b5443869164a9b36c5d837">Tcnt0</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">volatile</span> uint8_t* msk = &amp;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ac5acf2cfccbc491622eb809ece62b113">Timsk0</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">const</span> uint8_t* pDiv = source1Div;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    uint8_t  isrMask = source &amp; 0x3;;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (source &gt; <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6af01a0f3b78e977d18ca399618008ff76">CompareMatchSource2</a>)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        timer = &amp;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ab9f59cc6f7d5757ae90bdd8c97fac437">Tcnt2</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        pDiv = source2Div;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        msk = &amp;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ad13acfe4438f9f1cd67255ff9d96c1c3">Timsk2</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        isrMask = (source- <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a97e301986802ebf575ba220fbceb2f69">CompareMatchSource3</a>) &amp; 3;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="../../d2/d7f/_register_access_8h.html#af8f11a685f46bcd86b727c651674209d">SetRegister</a>(timer-&gt;<a class="code" href="../../d9/d52/struct_t_c_n_t8___t__tag.html#ae1ae3b1526dbf378e2e6359e5169285e">TCCRA</a>, (TCCRA_WGM, <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a1c812a5cefd048b58b1e87e2dfbd0c79a2499001f1eb0003273ae7092606248c6">ClrTmrOnCmpMatch</a>));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../d2/d7f/_register_access_8h.html#af8f11a685f46bcd86b727c651674209d">SetRegister</a>(timer-&gt;<a class="code" href="../../d9/d52/struct_t_c_n_t8___t__tag.html#a12a1aed38add959821a44e6b9709c9e2">TCCRB</a>, (TCCRB_CS, pDiv[frequency]));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keyword">volatile</span> uint8_t* pmatch = &amp;timer-&gt;<a class="code" href="../../d9/d52/struct_t_c_n_t8___t__tag.html#a180b96b3caee3b8f245ac6a37d8e8306">OCRA</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    pmatch[isrMask] = match;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    _compareMatchHandler[source] = handler;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    *msk |= 1 &lt;&lt; ((isrMask) + 1);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#acc879551df04aa1bcb4eadb27940e316">  217</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#acc879551df04aa1bcb4eadb27940e316">UnregisterCompareMatchInterrupt</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6">CompareMatchSource</a> source)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keyword">volatile</span> uint8_t* msk = &amp;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ac5acf2cfccbc491622eb809ece62b113">Timsk0</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (source &gt; <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a5886f6fdffdc058e9880a7401dec13a5">CompareMatchSource1</a>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        msk = &amp;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ad13acfe4438f9f1cd67255ff9d96c1c3">Timsk2</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    *msk &amp;= ~( 1 &lt;&lt; ((source &amp; 1) + 1));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    _compareMatchHandler[source] = 0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#ab8c6d3420ff0638bfc805b6923c9de59">  233</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#ab8c6d3420ff0638bfc805b6923c9de59">InitializeStateEventFramework</a>(<span class="keywordtype">void</span>) </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xCA);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xFE);    </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a9ad47b43b6a6439a61febaf77d680229">PortB</a>.DDR |= <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae2a530627b1279d21f2d5091f275ce26">PIN_5_mask</a>; <span class="comment">// set port b as outptut =&gt; this allows to toggle the led for debugging purpose!</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">while</span> (1)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a91b47cbb9f1e8a829dfac70b0aee3896">DispatchEvent</a>();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// process messages received from the UART</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">while</span> (USART_rxBufferOut != USART_rxBufferIn)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordtype">char</span> receivedData = USART_rxBuffer[USART_rxBufferOut++];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            USART_rxBufferOut %= <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(USART_rxBuffer);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a4a93759a841d46df0a83cb7fee321783">HandleMessage</a>(receivedData);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a1dca1e1280a33d82df0391e3d7406ec1">  254</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>()</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    _withinIsr = <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#aff72f6764c8a10001e915803d541a81d">  259</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>()</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    _withinIsr = <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a28f242ca7c35da297903671c944702f8">  264</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// in case we are in interrupt context, we must never reenable interrupts</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (_withinIsr) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    cli(); <span class="comment">// this just forces the bit to be cleared; should be possible to call this many times without side effect</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    _enterAtomicNesting++;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a39c9d65538111537b4ba8ec22a4f5d24">  274</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span> (_withinIsr) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (_enterAtomicNesting &gt; 0)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        _enterAtomicNesting--;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (_enterAtomicNesting == 0)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            sei();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a4a93759a841d46df0a83cb7fee321783">  288</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a4a93759a841d46df0a83cb7fee321783">HandleMessage</a>(<span class="keywordtype">char</span> receivedData)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keyword">static</span> uint8_t msgBuffer[14]; <span class="comment">// longest</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">static</span> uint8_t bufferIndex = 0;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">static</span> uint8_t msgType = 0;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">static</span> uint8_t msgLen = 0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (msgType == 0)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        msgType = receivedData;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        msgLen = 0;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msgLen == 0)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        msgLen = receivedData - 2;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        bufferIndex = 0;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bufferIndex &lt; msgLen)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        msgBuffer[bufferIndex++] = receivedData;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">if</span> (bufferIndex == msgLen)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a5778a2c9bd3532f9063233f1ae571771">ProcessMessage</a>(msgType, msgBuffer, msgLen);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            msgType = 0;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            bufferIndex = 0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a5778a2c9bd3532f9063233f1ae571771">  318</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a5778a2c9bd3532f9063233f1ae571771">ProcessMessage</a>(uint8_t msgType, uint8_t* msg, uint8_t msgLen)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">//Usart_PutChar(0xD1);</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (_avrPoolOut != _avrPoolIn)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        uint8_t msgIndex = _avrMsgIndex[_avrPoolOut++];</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        _avrPoolOut %= <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(_avrMsgIndex);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">//Usart_PutChar(0xD5);</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">//Usart_PutChar(msgIndex);</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">//Usart_PutChar(msgType^0xFF);</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        _avrMessagePool[msgIndex].<a class="code" href="../../d5/d8e/struct_avr_message__tag.html#a1cc06e7e3b464d0772fc8f28320101bd">MsgType</a> = msgType;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        _avrMessagePool[msgIndex].<a class="code" href="../../d5/d8e/struct_avr_message__tag.html#a2b1ba85fe7425ab62c629e2d39646b24">Length</a> = msgLen;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        memcpy(_avrMessagePool[msgIndex].Payload, msg, msgLen);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#add0902722b85415d9271d54289b2af87">SendMessage</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a16e22dcfff49a475a1800ef74b7bc33aa9bb3a84ea7f3bc413a03a15cd5f68c7b">Priority_0</a>, msgType | 0x80, msgIndex, 0);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a4a217d8dc26f12aedbfb56d503e2083b">  336</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a4a217d8dc26f12aedbfb56d503e2083b">StartTimer</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    _timerUs = 0;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a0a02ee9a96d6480e66b9584eb29cf06c">Tcnt1</a>.TCCRA = 0; <span class="comment">// normal timer operation</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a0a02ee9a96d6480e66b9584eb29cf06c">Tcnt1</a>.TCCRB = 2; <span class="comment">// clock divider = 8 =&gt; every tick is 0.5 us;</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    TIMSK1 |= 1; <span class="comment">// enable overflow interrupt</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}   </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#ae906eb0b63f420e1d52ae1872339830c">  344</a></span>&#160;uint32_t <a class="code" href="../../dc/d09/_avr_lib_8c.html#ae906eb0b63f420e1d52ae1872339830c">GetElapsedTime</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">//Tcnt1.OCRB &amp;= ~0x7; // stop the timer by setting its divider to 0</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    uint32_t us = (<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a0a02ee9a96d6480e66b9584eb29cf06c">Tcnt1</a>.TCNT &gt;&gt; 1) + _timerUs;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a0a02ee9a96d6480e66b9584eb29cf06c">Tcnt1</a>.TCNT = 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">return</span> us;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a0ed7424c2384342c95bcba6fe359dbc8">  353</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#acb441b04bb3e49642c14dd9987538778">SetState</a>(<a class="code" href="../../df/d89/struct_fsm__tag.html">Fsm</a>* fsm, <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a13ddd1c9e6959d8921c2a03c25259c74">StateHandler</a> handler)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    fsm-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#a60c28f55103a33bcb3962fc3c5c3108d">CurrentState</a> = handler; <span class="comment">// we never do this in interrupt context!</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#acf0585ec1d8dfc68002eb0e357aec8ea">  365</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#acf0585ec1d8dfc68002eb0e357aec8ea">RegisterFsm</a>(<a class="code" href="../../df/d89/struct_fsm__tag.html">Fsm</a>* fsm)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="../../df/d89/struct_fsm__tag.html">Fsm</a>* p = &amp;_anchor;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="../../df/d89/struct_fsm__tag.html">Fsm</a>* q = p-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Next</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">while</span> (q != &amp;_anchor)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        p = q;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        q = q-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Next</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    p-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Next</a> = fsm;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    fsm-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Next</a> = q;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a91b47cbb9f1e8a829dfac70b0aee3896">  379</a></span>&#160;<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a91b47cbb9f1e8a829dfac70b0aee3896">DispatchEvent</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a> msg = { .<a class="code" href="../../d3/d6f/struct_message__tag.html#abaeb5d499fed378ac6832d36de77bbdf">Id</a> = 0, .__next = 0 };</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/d09/_avr_lib_8c.html#a4e2c9921140ec91965eb41df4f2e79f3">GetMessage</a>(&amp;msg))</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">if</span> (msg.<a class="code" href="../../d3/d6f/struct_message__tag.html#abaeb5d499fed378ac6832d36de77bbdf">Id</a> &amp; 0x80) <span class="comment">// this was a AVR message =&gt; pass it to the messageHandler</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            uint8_t msgIndex = msg.<a class="code" href="../../d3/d6f/struct_message__tag.html#aaafeafacfe3dadc5541605cc0da13c35">MsgParamLow</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="comment">//Usart_PutChar(msgIndex);</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <a class="code" href="../../d5/d8e/struct_avr_message__tag.html">AvrMessage</a>* avrMsg = &amp;_avrMessagePool[msgIndex];</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="comment">//Usart_PutChar(avrMsg-&gt;MsgType ^ 0xFF);</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            HandleAvrMessage(avrMsg);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            _avrMsgIndex[_avrPoolIn++] = msgIndex;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            _avrPoolIn %= <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(_avrMsgIndex);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <a class="code" href="../../df/d89/struct_fsm__tag.html">Fsm</a>* p = _anchor.<a class="code" href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Next</a>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            uint8_t prioFlag = 1 &lt;&lt; msg.<a class="code" href="../../d3/d6f/struct_message__tag.html#a2e0462cee9727c48ffba3fe0d02e6395">Priority</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">while</span> (p != &amp;_anchor)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="keywordflow">if</span> ((p-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#ab7668ff9f0f7f2a6cb9ed24f7f0a905b">RxMask</a> &amp; prioFlag) != 0)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    p-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#a60c28f55103a33bcb3962fc3c5c3108d">CurrentState</a>( &amp;msg );</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                p = p-&gt;<a class="code" href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Next</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">//Usart_PutChar(0xB2);</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#add0902722b85415d9271d54289b2af87">  418</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#add0902722b85415d9271d54289b2af87">SendMessage</a>(uint8_t prio, uint8_t <span class="keywordtype">id</span>, uint8_t msgLow, uint8_t msgHigh)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;{</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">//uint8_t nextMessageIn = (_qIn + 1) % (countof(_prioQueue));</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a9ad47b43b6a6439a61febaf77d680229">PortB</a>.PORT |= <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae2a530627b1279d21f2d5091f275ce26">PIN_5_mask</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    uint8_t nextIn = (_qIn + 1) % <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(_messagePool);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (nextIn == _qOut)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xDE);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xAD);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// todo: what shall be done in case a message is discarded?</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// get a free slot</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>* msg = &amp;_messagePool[_messagePoolIndex[_qIn]];</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    _qIn = nextIn;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a> != 0)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    { </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xDE);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xAD);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xBE);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(0xAF);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">while</span> (1)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a9ad47b43b6a6439a61febaf77d680229">PortB</a>.PORT ^= <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae2a530627b1279d21f2d5091f275ce26">PIN_5_mask</a>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            _delay_ms(1000);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#a2e0462cee9727c48ffba3fe0d02e6395">Priority</a> = prio;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#abaeb5d499fed378ac6832d36de77bbdf">Id</a> = id;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#aaafeafacfe3dadc5541605cc0da13c35">MsgParamLow</a> = msgLow;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ac151a25233807367672981a8d3affccd">MsgParamHigh</a> = msgHigh;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>* p = &amp;_root;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>* q = p;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// search place in the priority list to insert the message</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">while</span> (msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#a2e0462cee9727c48ffba3fe0d02e6395">Priority</a> &lt;= p-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#a2e0462cee9727c48ffba3fe0d02e6395">Priority</a> &amp;&amp; p-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a> != &amp;_root )</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        q = p;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        p = p-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a> = q-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    q-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a> = msg;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a9ad47b43b6a6439a61febaf77d680229">PortB</a>.PORT ^= <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae2a530627b1279d21f2d5091f275ce26">PIN_5_mask</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a4e2c9921140ec91965eb41df4f2e79f3">  470</a></span>&#160;<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a4e2c9921140ec91965eb41df4f2e79f3">GetMessage</a>(<a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>* msg)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;{</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>* p = &amp;_root;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>* q = _root.<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a> retValue = <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (p != q) <span class="comment">// there is an element in the queue</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">// get the first element in the queue</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        *msg = *q;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        msg-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a> = 0;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">// set pointer back to free list</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        _messagePoolIndex[_qOut++] = q-_messagePool;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        _root.<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a> = q-&gt;<a class="code" href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">__next</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        memset(q, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d6f/struct_message__tag.html">Message</a>));</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        _qOut %= <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(_messagePoolIndex);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        retValue = <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> retValue;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#ifdef __AVR_ATmega328P__</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#ifndef F_CPU</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">#define F_CPU 16000000</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#abb586ce66a7472c329436a697b08afa7">  502</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#abb586ce66a7472c329436a697b08afa7">Usart_Init</a>(uint32_t baudrate)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;{</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a9ad47b43b6a6439a61febaf77d680229">PortB</a>.DDR |= (<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a6b2abe5f24f38e129aea0be5b0289608">PIN_4_mask</a>|<a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae2a530627b1279d21f2d5091f275ce26">PIN_5_mask</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">/*Set baud rate */</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UBBR = (uint16_t)(<a class="code" href="../../dc/d09/_avr_lib_8c.html#a43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a>/16/baudrate -1);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">/*Enable receiver and transmitter */</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="../../d2/d7f/_register_access_8h.html#af8f11a685f46bcd86b727c651674209d">SetRegister</a>(<a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UCSRB, (UCSRB_RXEN, 1),(UCSRB_RXCIEN, <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>),(UCSRB_TXEN, <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>));</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">/* Set frame format: 8data, 2stop bit; work in  */</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="../../d2/d7f/_register_access_8h.html#af8f11a685f46bcd86b727c651674209d">SetRegister</a>(<a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UCSRC, (UCSRC_USBS, 1), (UCSRC_UCSZ01, 3));</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// enable interupts</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    sei();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a03b563cafd3a70587ff8d9465578736b">  518</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(<span class="keywordtype">char</span> ch)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;{</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">//PortB.PORT |= PIN_4_mask;</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    uint8_t nextIn = 0;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    nextIn = (USART_txBufferIn + 1) % <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(USART_txBuffer);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">if</span> (nextIn != USART_txBufferOut)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        USART_txBuffer[USART_txBufferIn] = ch;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        USART_txBufferIn = nextIn;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UCSRB |= <a class="code" href="../../d1/d99/_atmega328_p_8h.html#a0eac0bc26fecdd3b3fdc408ddc74ceb8">UCSRB_UDRIEN_mask</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//PortB.PORT &amp;= ~PIN_4_mask;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a9a0337485f778f9303e01818b2547d02">  534</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a588a1233b2343862198fbe6f657640c0">ISR_UsartDataRegEmpty</a>()</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;{   </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (USART_txBufferOut != USART_txBufferIn)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UDR = USART_txBuffer[USART_txBufferOut++];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        USART_txBufferOut %= <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(USART_txBuffer);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span> (USART_txBufferOut == USART_txBufferIn)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="../../d2/d7f/_register_access_8h.html#aae46f7142feaa5f8637cf3918b91201b">UpdateRegister</a>(<a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UCSRB, (UCSRB_UDRIEN, <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a25169aec28158deda372c5f4d8696b6d">  549</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a25169aec28158deda372c5f4d8696b6d">AllowUartRx</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;{</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UCSRB |= <a class="code" href="../../d1/d99/_atmega328_p_8h.html#accb43604f74b884f0fae5fe1e0c712b3">UCSRB_RXCIEN_mask</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;}</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a7a6b7c45c2b33f36238d5676dbc1fdf8">  554</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a7a6b7c45c2b33f36238d5676dbc1fdf8">DisallowUartRx</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;{</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UCSRB &amp;= ~<a class="code" href="../../d1/d99/_atmega328_p_8h.html#accb43604f74b884f0fae5fe1e0c712b3"> UCSRB_RXCIEN_mask</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#aa1d4b90dd2d41dcba7b76fdb15be3279">  560</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a74cbb67841ba93ac25e495211ff9bcc2">ISR_UsartRxComplete</a>()</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UCSRA &amp; <a class="code" href="../../d1/d99/_atmega328_p_8h.html#ae677f87cc03fec0c21040ac505a0a20c">UCSRA_RXC_mask</a>)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordtype">char</span> receivedChar = <a class="code" href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a>.UDR;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        uint8_t nextInput = (USART_rxBufferIn + 1) % <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(USART_rxBuffer);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">if</span> ((nextInput) != USART_rxBufferOut)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            USART_rxBuffer[USART_rxBufferIn] = receivedChar;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            USART_rxBufferIn = nextInput;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a63cfe47a79279085ee59b1644cf9ab60">  577</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a5f30a7e5cf65d77d1e62fe5cfd808abd">ISR_ExtInt0</a>()</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;{</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (_extIntHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601abe5535bcbfec4d06d24c2aa0b69ea604">ExtInterruptSource0</a>] != 0)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        _extIntHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601abe5535bcbfec4d06d24c2aa0b69ea604">ExtInterruptSource0</a>]();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;}</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a6ae4ad8192e6928ac4f7e3e59001e53a">  587</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a138ee101782f1162739571acabf60bbf">ISR_ExtInt1</a>()</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (_extIntHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601accf7dd3aeb8c08cb2c901cd3a9e29085">ExtInterruptSource1</a>] != 0)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        _extIntHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601accf7dd3aeb8c08cb2c901cd3a9e29085">ExtInterruptSource1</a>]();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#ad2205f131ddc00a55862357d04b64e24">  598</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a6f4fd6ca4faeb94544eeb0e8ba2acf21">ISR_Tcnt0CompareMatchA</a>()</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (_compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a5886f6fdffdc058e9880a7401dec13a5">CompareMatchSource1</a>] != 0)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        _compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a5886f6fdffdc058e9880a7401dec13a5">CompareMatchSource1</a>]();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a267ca92fcda9b5965694b9c8b940d20e">  608</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a0e994ab2ac32cc3c00145640e9215756">ISR_Tcnt0CompareMatchB</a>()</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;{</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span> (_compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6af01a0f3b78e977d18ca399618008ff76">CompareMatchSource2</a>] != 0)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        _compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6af01a0f3b78e977d18ca399618008ff76">CompareMatchSource2</a>]();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;}</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a452562d7ce876fc3a4943bd345dd9d9c">  618</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#acc709deb2f4d1673bfbf2289e3b7d82e">ISR_Tcnt2CompareMatchA</a>()</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span> (_compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a97e301986802ebf575ba220fbceb2f69">CompareMatchSource3</a>] != 0)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        _compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a97e301986802ebf575ba220fbceb2f69">CompareMatchSource3</a>]();</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a43b49e7a23a6076f63106b90b6fadfe3">  628</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a8574626844a4b315863b5787fe351a34">ISR_Tcnt2CompareMatchB</a>()</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;{</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a>();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> (_compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6aedd1e3f83271d3c1eb156e52c6ff3c10">CompareMatchSource4</a>] != 0)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        _compareMatchHandler[<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6aedd1e3f83271d3c1eb156e52c6ff3c10">CompareMatchSource4</a>]();</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a>();</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;}</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#ac4fa6e85d9f21e9326904d2b202c82e0">  638</a></span>&#160;<a class="code" href="../../d1/d99/_atmega328_p_8h.html#a89b05e0991ee86bfe03a5fae972c2491">ISR_Tcnt1Overflow</a>()</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;{</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    _timerUs += 0x7FFF; <span class="comment">// this is the amount of us that has elapsed</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#abb586ce66a7472c329436a697b08afa7">Usart_Init</a>(uint32_t baudrate) <span class="comment">//tbd fix this for atmega32!</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;{</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    UBRRH = 0;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">//UBRRL = 12;                           // initialize baud rate = 38400 at 8MHZ</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    UBRRL = 5;                              <span class="comment">// initialize baud rate 34800 at 3.68MHz</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    UCSRC = 0x86;                           <span class="comment">// 8 data bits, 1 stop bit, not parity; docu page 162</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    UCSRB = (1&lt;&lt;TXEN)|(1&lt;&lt;RXEN)|(1&lt;&lt;RXCIE)|(1&lt;&lt;TXCIE);  <span class="comment">// enabe tx, rx and rx, tx interrupts</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    sei();                                  <span class="comment">// enable interrupts</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a25169aec28158deda372c5f4d8696b6d">AllowUartRx</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    UCSRB |= (1&lt;&lt;RXCIE);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a7a6b7c45c2b33f36238d5676dbc1fdf8">DisallowUartRx</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;{</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    UCSRB &amp;= ~(1&lt;&lt;RXCIE);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;ISR(USART_RXC_vect)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;{</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">while</span> (UCSRA &amp; (1 &lt;&lt; RXC))</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordtype">char</span> receivedChar = UDR;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        uint8_t nextInput = (USART_rxBufferIn + 1) % <a class="code" href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(USART_rxBuffer);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">if</span> ((nextInput) != USART_rxBufferOut)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            USART_rxBuffer[USART_rxBufferIn] = receivedChar;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            USART_rxBufferIn = nextInput;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;}</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(<span class="keywordtype">char</span> ch)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;{</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    UDR = ch;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">while</span> (!(UCSRA &amp; (1 &lt;&lt; UDRE)));</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">  694</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(uint16_t val)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(val &gt;&gt; 8);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(val &amp; 0xFF);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;}</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">  700</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">Usart_TraceN</a>(uint16_t <span class="keywordtype">id</span>, <span class="keyword">const</span> uint8_t* pVal, int8_t len)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// avoid partial messages!</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../dc/d09/_avr_lib_8c.html#a21d527450b438bba8dab02e03f021ee3">USART_TX_BUFFER_SIZE</a> - 1 - <a class="code" href="../../dc/d09/_avr_lib_8c.html#a6fed9d9c8d3db2b0bfed3ae69b914827">FilledTxEntries</a>()) &gt;= (len + 4))</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa82dcf9244c49b9d3de690d58987a5ef2">PacketType_TraceMessage</a>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa3b77c5f682b11fcb16bd520a1e05615f">PacketType_TraceMassagePadLen</a> | len);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keywordflow">while</span> (len-- &gt; 0)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(*pVal++);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;}</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a13526c993e9f5423f81f0778e813fea6">  717</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a13526c993e9f5423f81f0778e813fea6">Usart_Trace0</a>(uint16_t <span class="keywordtype">id</span>)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;{</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">Usart_TraceN</a>(<span class="keywordtype">id</span>, 0, 0);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a559f64e8fc8a1b2c123571f7b0701bef">  723</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a7920cad57328487833bec6dfc8169ff0">Usart_Trace1</a>(uint16_t <span class="keywordtype">id</span>, uint8_t ch)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">Usart_TraceN</a>(<span class="keywordtype">id</span>, &amp;ch, 1);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;}</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a76fa4637266422b10e127082d5ede5af">  728</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a76fa4637266422b10e127082d5ede5af">Usart_Trace2</a>(uint16_t <span class="keywordtype">id</span>, uint8_t val1, uint8_t val2)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;{</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    uint8_t buffer[2] = {val1, val2};</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">Usart_TraceN</a>(<span class="keywordtype">id</span>, buffer, 2);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;}</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#aff59557715efa0b5789b84418a503202">  734</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#aff59557715efa0b5789b84418a503202">Usart_Trace3</a>(uint16_t <span class="keywordtype">id</span>, uint8_t val1, uint8_t val2, uint8_t val3)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;{</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    uint8_t buffer[3] = {val1, val2, val3};</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">Usart_TraceN</a>(<span class="keywordtype">id</span>, buffer, 3);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;}</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a82e177e9c019be8b539490050cce6641">  740</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a82e177e9c019be8b539490050cce6641">Usart_Trace4</a>(uint16_t <span class="keywordtype">id</span>, uint8_t val1, uint8_t val2, uint8_t val3, uint8_t val4)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;{</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    uint8_t buffer[4] = {val1, val2, val3, val4};</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">Usart_TraceN</a>(<span class="keywordtype">id</span>, buffer, 4);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;}</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a250b4b7a63e26fd06875a2ae7f769603">  746</a></span>&#160;<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a7b883ddec9db2ef9aff1d336b0b4be3b">AvrMessageHandler</a> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a250b4b7a63e26fd06875a2ae7f769603">RegisterAvrMessageHandler</a>(<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a7b883ddec9db2ef9aff1d336b0b4be3b">AvrMessageHandler</a> handler)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;{</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a7b883ddec9db2ef9aff1d336b0b4be3b">AvrMessageHandler</a> oldHandler = HandleAvrMessage;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">if</span>( handler != 0)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        HandleAvrMessage = handler;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">return</span> oldHandler;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;}</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno"><a class="line" href="../../d9/dcd/_avr_lib_8h.html#a0e58fe56e60a05f16b28a549f5fdae51">  757</a></span>&#160;<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a> <a class="code" href="../../dc/d09/_avr_lib_8c.html#a0e58fe56e60a05f16b28a549f5fdae51">DefaultMessageHandler</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d8e/struct_avr_message__tag.html">AvrMessage</a>* msg)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">//PortB.PORT |= PIN_5_mask;</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="../../d5/d8e/struct_avr_message__tag.html#a1cc06e7e3b464d0772fc8f28320101bd">MsgType</a> == <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa7661b2c4df7f44ff4d4d0cd2c701cc52">PacketType_ReadRegister</a>)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="../../d0/d70/struct_cmd_read_reg.html">CmdReadReg</a>* pReadReg = (<a class="code" href="../../d0/d70/struct_cmd_read_reg.html">CmdReadReg</a>*)msg-&gt;<a class="code" href="../../d5/d8e/struct_avr_message__tag.html#aec2f4e71f5d2fe9ecae681a068e987e3">Payload</a>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        uint16_t header = (<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa7661b2c4df7f44ff4d4d0cd2c701cc52">PacketType_ReadRegister</a>&lt;&lt;8) | (pReadReg-&gt;<a class="code" href="../../d0/d70/struct_cmd_read_reg.html#a5723e60ffd628510c699eddbce90be23">len</a>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">if</span> (pReadReg-&gt;<a class="code" href="../../d0/d70/struct_cmd_read_reg.html#a5723e60ffd628510c699eddbce90be23">len</a> == 1)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            uint8_t* regAddr = (uint8_t*)pReadReg-&gt;<a class="code" href="../../d0/d70/struct_cmd_read_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">adress</a>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            uint8_t <span class="keywordtype">byte</span> = *regAddr;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(header);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a>(<span class="keywordtype">byte</span>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pReadReg-&gt;<a class="code" href="../../d0/d70/struct_cmd_read_reg.html#a5723e60ffd628510c699eddbce90be23">len</a> == 2)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            uint16_t* regAddr = (uint16_t*)pReadReg-&gt;<a class="code" href="../../d0/d70/struct_cmd_read_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">adress</a>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            uint16_t word = *regAddr;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(header);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(word);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            header &amp;= 0xFF;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(header);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="comment">//PortB.PORT &amp;= ~PIN_5_mask;</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="../../d5/d8e/struct_avr_message__tag.html#a1cc06e7e3b464d0772fc8f28320101bd">MsgType</a> == <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa2157e2cfa1ffb5844704bcb5c637bb81">PacketType_WriteRegister</a>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <a class="code" href="../../dd/d22/struct_cmd_write_reg.html">CmdWriteReg</a>* pWriteReg = (<a class="code" href="../../dd/d22/struct_cmd_write_reg.html">CmdWriteReg</a>* )msg-&gt;<a class="code" href="../../d5/d8e/struct_avr_message__tag.html#aec2f4e71f5d2fe9ecae681a068e987e3">Payload</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        uint16_t status = (<a class="code" href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa2157e2cfa1ffb5844704bcb5c637bb81">PacketType_WriteRegister</a>&lt;&lt;8)|1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a>();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keywordflow">if</span> (pWriteReg-&gt;<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a5723e60ffd628510c699eddbce90be23">len</a> == 1)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            uint8_t* regAddr = (uint8_t*)pWriteReg-&gt;<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">adress</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            *regAddr = pWriteReg-&gt;<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a582f3f7dde5c677ef7b3c6fc7d27beb4">data</a>.<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a96f44d20f1dbf1c8785a7bc99a46164c">byte</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pWriteReg-&gt;<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a5723e60ffd628510c699eddbce90be23">len</a> == 2)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            uint16_t* regAddr = (uint16_t*)pWriteReg-&gt;<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">adress</a>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            *regAddr = pWriteReg-&gt;<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#a582f3f7dde5c677ef7b3c6fc7d27beb4">data</a>.<a class="code" href="../../dd/d22/struct_cmd_write_reg.html#af9036114e498c9fcb670232e4227341a">word</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            status &amp;= 0xFF00;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a>(status);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a>();</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;}</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="ttc" id="a_atmega328_p_8h_html"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html">Atmega328P.h</a></div><div class="ttdoc">automatically generated; do not edit</div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a0a02ee9a96d6480e66b9584eb29cf06c"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a0a02ee9a96d6480e66b9584eb29cf06c">Tcnt1</a></div><div class="ttdeci">#define Tcnt1</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00934">Atmega328P.h:934</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a0e994ab2ac32cc3c00145640e9215756"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a0e994ab2ac32cc3c00145640e9215756">ISR_Tcnt0CompareMatchB</a></div><div class="ttdeci">#define ISR_Tcnt0CompareMatchB()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00032">Atmega328P.h:32</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a0eac0bc26fecdd3b3fdc408ddc74ceb8"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a0eac0bc26fecdd3b3fdc408ddc74ceb8">UCSRB_UDRIEN_mask</a></div><div class="ttdeci">#define UCSRB_UDRIEN_mask</div><div class="ttdoc">bitfield UDRIEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00593">Atmega328P.h:593</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a138ee101782f1162739571acabf60bbf"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a138ee101782f1162739571acabf60bbf">ISR_ExtInt1</a></div><div class="ttdeci">#define ISR_ExtInt1()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00019">Atmega328P.h:19</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a1c812a5cefd048b58b1e87e2dfbd0c79a2499001f1eb0003273ae7092606248c6"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a1c812a5cefd048b58b1e87e2dfbd0c79a2499001f1eb0003273ae7092606248c6">ClrTmrOnCmpMatch</a></div><div class="ttdeci">@ ClrTmrOnCmpMatch</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00318">Atmega328P.h:318</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a29e45ee79c975841f5fed67d19101c43"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a29e45ee79c975841f5fed67d19101c43">ADCSRA_ADSC_mask</a></div><div class="ttdeci">#define ADCSRA_ADSC_mask</div><div class="ttdoc">bitfield ADSC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00715">Atmega328P.h:715</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a4ac9a19089919bbb987c7d53d373465c"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a4ac9a19089919bbb987c7d53d373465c">ReferenceSelection</a></div><div class="ttdeci">ReferenceSelection</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00820">Atmega328P.h:821</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a588a1233b2343862198fbe6f657640c0"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a588a1233b2343862198fbe6f657640c0">ISR_UsartDataRegEmpty</a></div><div class="ttdeci">#define ISR_UsartDataRegEmpty()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00036">Atmega328P.h:36</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a5f30a7e5cf65d77d1e62fe5cfd808abd"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a5f30a7e5cf65d77d1e62fe5cfd808abd">ISR_ExtInt0</a></div><div class="ttdeci">#define ISR_ExtInt0()</div><div class="ttdoc">macros to define interrupt service routines</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00018">Atmega328P.h:18</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a5fdf9101a55da8ca267845a362e3d1ef"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a5fdf9101a55da8ca267845a362e3d1ef">AdcPrescaler</a></div><div class="ttdeci">AdcPrescaler</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00726">Atmega328P.h:727</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a6b2abe5f24f38e129aea0be5b0289608"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a6b2abe5f24f38e129aea0be5b0289608">PIN_4_mask</a></div><div class="ttdeci">#define PIN_4_mask</div><div class="ttdoc">bitfield _4</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00235">Atmega328P.h:235</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a6f4fd6ca4faeb94544eeb0e8ba2acf21"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a6f4fd6ca4faeb94544eeb0e8ba2acf21">ISR_Tcnt0CompareMatchA</a></div><div class="ttdeci">#define ISR_Tcnt0CompareMatchA()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00031">Atmega328P.h:31</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a74cbb67841ba93ac25e495211ff9bcc2"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a74cbb67841ba93ac25e495211ff9bcc2">ISR_UsartRxComplete</a></div><div class="ttdeci">#define ISR_UsartRxComplete()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00035">Atmega328P.h:35</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a7502590be27d44096272c31c1798dd16"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a7502590be27d44096272c31c1798dd16">Eicra</a></div><div class="ttdeci">#define Eicra</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00929">Atmega328P.h:929</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a8574626844a4b315863b5787fe351a34"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a8574626844a4b315863b5787fe351a34">ISR_Tcnt2CompareMatchB</a></div><div class="ttdeci">#define ISR_Tcnt2CompareMatchB()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00025">Atmega328P.h:25</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a867aef8dd8b5443869164a9b36c5d837"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a867aef8dd8b5443869164a9b36c5d837">Tcnt0</a></div><div class="ttdeci">#define Tcnt0</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00925">Atmega328P.h:925</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a89b05e0991ee86bfe03a5fae972c2491"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a89b05e0991ee86bfe03a5fae972c2491">ISR_Tcnt1Overflow</a></div><div class="ttdeci">#define ISR_Tcnt1Overflow()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00030">Atmega328P.h:30</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_a9ad47b43b6a6439a61febaf77d680229"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#a9ad47b43b6a6439a61febaf77d680229">PortB</a></div><div class="ttdeci">#define PortB</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00918">Atmega328P.h:918</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_aa1e71c1b0af3b85ba60ee6afc8ab5455"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#aa1e71c1b0af3b85ba60ee6afc8ab5455">Eimsk</a></div><div class="ttdeci">#define Eimsk</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00922">Atmega328P.h:922</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_ab9f59cc6f7d5757ae90bdd8c97fac437"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#ab9f59cc6f7d5757ae90bdd8c97fac437">Tcnt2</a></div><div class="ttdeci">#define Tcnt2</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00935">Atmega328P.h:935</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_ac5acf2cfccbc491622eb809ece62b113"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#ac5acf2cfccbc491622eb809ece62b113">Timsk0</a></div><div class="ttdeci">#define Timsk0</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00930">Atmega328P.h:930</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_acc709deb2f4d1673bfbf2289e3b7d82e"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#acc709deb2f4d1673bfbf2289e3b7d82e">ISR_Tcnt2CompareMatchA</a></div><div class="ttdeci">#define ISR_Tcnt2CompareMatchA()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00024">Atmega328P.h:24</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_accb43604f74b884f0fae5fe1e0c712b3"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#accb43604f74b884f0fae5fe1e0c712b3">UCSRB_RXCIEN_mask</a></div><div class="ttdeci">#define UCSRB_RXCIEN_mask</div><div class="ttdoc">bitfield RXCIEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00607">Atmega328P.h:607</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_aced27cb9f5de7573f7ef7c25909b3084"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#aced27cb9f5de7573f7ef7c25909b3084">AnalogChannelSelection</a></div><div class="ttdeci">AnalogChannelSelection</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00805">Atmega328P.h:806</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_ad13acfe4438f9f1cd67255ff9d96c1c3"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#ad13acfe4438f9f1cd67255ff9d96c1c3">Timsk2</a></div><div class="ttdeci">#define Timsk2</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00932">Atmega328P.h:932</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_add919630dce91bed2649b01fad1ed986"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#add919630dce91bed2649b01fad1ed986">Usart</a></div><div class="ttdeci">#define Usart</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00936">Atmega328P.h:936</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_ae127b12c81d0f75ba411327d0d7ab35b"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#ae127b12c81d0f75ba411327d0d7ab35b">Adc</a></div><div class="ttdeci">#define Adc</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00933">Atmega328P.h:933</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_ae2a530627b1279d21f2d5091f275ce26"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#ae2a530627b1279d21f2d5091f275ce26">PIN_5_mask</a></div><div class="ttdeci">#define PIN_5_mask</div><div class="ttdoc">bitfield _5</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00242">Atmega328P.h:242</a></div></div>
<div class="ttc" id="a_atmega328_p_8h_html_ae677f87cc03fec0c21040ac505a0a20c"><div class="ttname"><a href="../../d1/d99/_atmega328_p_8h.html#ae677f87cc03fec0c21040ac505a0a20c">UCSRA_RXC_mask</a></div><div class="ttdeci">#define UCSRA_RXC_mask</div><div class="ttdoc">bitfield RXC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00502">Atmega328P.h:502</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a03b563cafd3a70587ff8d9465578736b"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a03b563cafd3a70587ff8d9465578736b">Usart_PutChar</a></div><div class="ttdeci">void Usart_PutChar(char ch)</div><div class="ttdoc">Put one charactor to the Uart.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00518">AvrLib.c:518</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a0e58fe56e60a05f16b28a549f5fdae51"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a0e58fe56e60a05f16b28a549f5fdae51">DefaultMessageHandler</a></div><div class="ttdeci">Bool DefaultMessageHandler(const AvrMessage *msg)</div><div class="ttdoc">This is the default message handler which is set during initialisation of global variables.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00757">AvrLib.c:757</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a13526c993e9f5423f81f0778e813fea6"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a13526c993e9f5423f81f0778e813fea6">Usart_Trace0</a></div><div class="ttdeci">void Usart_Trace0(uint16_t id)</div><div class="ttdoc">Don't bother about these implementations; you should not use them directly; that's up to the build pr...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00717">AvrLib.c:717</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a21d527450b438bba8dab02e03f021ee3"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a21d527450b438bba8dab02e03f021ee3">USART_TX_BUFFER_SIZE</a></div><div class="ttdeci">#define USART_TX_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00043">AvrLib.c:43</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a250b4b7a63e26fd06875a2ae7f769603"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a250b4b7a63e26fd06875a2ae7f769603">RegisterAvrMessageHandler</a></div><div class="ttdeci">AvrMessageHandler RegisterAvrMessageHandler(AvrMessageHandler handler)</div><div class="ttdoc">Register a test handler.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00746">AvrLib.c:746</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a25169aec28158deda372c5f4d8696b6d"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a25169aec28158deda372c5f4d8696b6d">AllowUartRx</a></div><div class="ttdeci">void AllowUartRx(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00549">AvrLib.c:549</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a28f242ca7c35da297903671c944702f8"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a28f242ca7c35da297903671c944702f8">EnterAtomic</a></div><div class="ttdeci">void EnterAtomic(void)</div><div class="ttdoc">guarantee exclusive access!</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00264">AvrLib.c:264</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a39c9d65538111537b4ba8ec22a4f5d24"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a39c9d65538111537b4ba8ec22a4f5d24">LeaveAtomic</a></div><div class="ttdeci">void LeaveAtomic(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00274">AvrLib.c:274</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a43bafb28b29491ec7f871319b5a3b2f8"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a43bafb28b29491ec7f871319b5a3b2f8">F_CPU</a></div><div class="ttdeci">#define F_CPU</div><div class="ttdoc">UartHandler.c.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00023">AvrLib.c:23</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a4a217d8dc26f12aedbfb56d503e2083b"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a4a217d8dc26f12aedbfb56d503e2083b">StartTimer</a></div><div class="ttdeci">void StartTimer(void)</div><div class="ttdoc">Start the Timer on Tcnt1 and reset internal counters.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00336">AvrLib.c:336</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a4a93759a841d46df0a83cb7fee321783"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a4a93759a841d46df0a83cb7fee321783">HandleMessage</a></div><div class="ttdeci">void HandleMessage(char receivedData)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00288">AvrLib.c:288</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a4e2c9921140ec91965eb41df4f2e79f3"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a4e2c9921140ec91965eb41df4f2e79f3">GetMessage</a></div><div class="ttdeci">Bool GetMessage(Message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00470">AvrLib.c:470</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a5778a2c9bd3532f9063233f1ae571771"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a5778a2c9bd3532f9063233f1ae571771">ProcessMessage</a></div><div class="ttdeci">void ProcessMessage(uint8_t msgType, uint8_t *msg, uint8_t msgLen)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00318">AvrLib.c:318</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a683398ef655b92d30d7e8605e0262630"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a683398ef655b92d30d7e8605e0262630">Usart_TraceN</a></div><div class="ttdeci">void Usart_TraceN(uint16_t id, const uint8_t *pVal, int8_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00700">AvrLib.c:700</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a689c8adc347f1499e90f601a55975c8d"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a689c8adc347f1499e90f601a55975c8d">RegisterExternalInteruptHandler</a></div><div class="ttdeci">void RegisterExternalInteruptHandler(ExtInteruptSource source, ExtIntTrigger trigger, IsrHandler handler)</div><div class="ttdoc">Setup exernal Interrupt source.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00139">AvrLib.c:139</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a6fed9d9c8d3db2b0bfed3ae69b914827"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a6fed9d9c8d3db2b0bfed3ae69b914827">FilledTxEntries</a></div><div class="ttdeci">#define FilledTxEntries()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00048">AvrLib.c:48</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a76fa4637266422b10e127082d5ede5af"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a76fa4637266422b10e127082d5ede5af">Usart_Trace2</a></div><div class="ttdeci">void Usart_Trace2(uint16_t id, uint8_t val1, uint8_t val2)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00728">AvrLib.c:728</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a7920cad57328487833bec6dfc8169ff0"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a7920cad57328487833bec6dfc8169ff0">Usart_Trace1</a></div><div class="ttdeci">void Usart_Trace1(uint16_t id, uint8_t ch)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00723">AvrLib.c:723</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a7a6b7c45c2b33f36238d5676dbc1fdf8"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a7a6b7c45c2b33f36238d5676dbc1fdf8">DisallowUartRx</a></div><div class="ttdeci">void DisallowUartRx(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00554">AvrLib.c:554</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a81a5f6d0fbdccf837ea80a52da409049"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a81a5f6d0fbdccf837ea80a52da409049">MeasureOnce</a></div><div class="ttdeci">uint16_t MeasureOnce(AnalogChannelSelection channel, ReferenceSelection Vref, AdcPrescaler prescaler)</div><div class="ttdoc">Execute a single measurement on the ADC.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00120">AvrLib.c:120</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a82e177e9c019be8b539490050cce6641"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a82e177e9c019be8b539490050cce6641">Usart_Trace4</a></div><div class="ttdeci">void Usart_Trace4(uint16_t id, uint8_t val1, uint8_t val2, uint8_t val3, uint8_t val4)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00740">AvrLib.c:740</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a8914817066cdfdab2483afdd3ecc8ada"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a8914817066cdfdab2483afdd3ecc8ada">Usart_PutShort</a></div><div class="ttdeci">void Usart_PutShort(uint16_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00694">AvrLib.c:694</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a8b25b1e93b8abeba01759090ce24e9b4"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a8b25b1e93b8abeba01759090ce24e9b4">IsrLeave</a></div><div class="ttdeci">void IsrLeave()</div><div class="ttdoc">mark end of ISR</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00259">AvrLib.c:259</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a915c5dd805b9fe49be4ca3fcd55b5e31"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a915c5dd805b9fe49be4ca3fcd55b5e31">TestHandler</a></div><div class="ttdeci">Fsm TestHandler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00036">AvrLib.c:36</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_a91b47cbb9f1e8a829dfac70b0aee3896"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#a91b47cbb9f1e8a829dfac70b0aee3896">DispatchEvent</a></div><div class="ttdeci">Bool DispatchEvent(void)</div><div class="ttdoc">Funktion um ein event an die registrierten Zustandsmaschinen zu verteilen.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00379">AvrLib.c:379</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_aa7af134495334451f5e03dde3166ed8a"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#aa7af134495334451f5e03dde3166ed8a">IsrEnter</a></div><div class="ttdeci">void IsrEnter()</div><div class="ttdoc">mark beginning of ISR</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00254">AvrLib.c:254</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_aae6299783f51d753125be1a8c2d830be"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#aae6299783f51d753125be1a8c2d830be">RegisterCompareMatchInterrupt</a></div><div class="ttdeci">void RegisterCompareMatchInterrupt(CompareMatchSource source, TimerFrequency frequency, uint8_t match, IsrHandler handler)</div><div class="ttdoc">Setup compare match interrupt on one of four available interrupt sources.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00194">AvrLib.c:194</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_ab8c6d3420ff0638bfc805b6923c9de59"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#ab8c6d3420ff0638bfc805b6923c9de59">InitializeStateEventFramework</a></div><div class="ttdeci">void InitializeStateEventFramework(void)</div><div class="ttdoc">Initialisierung des Anfangszustandes.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00233">AvrLib.c:233</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_abab4c4585c5bc06434241babc8460e7b"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#abab4c4585c5bc06434241babc8460e7b">SetExtInterruptEnable</a></div><div class="ttdeci">void SetExtInterruptEnable(ExtInteruptSource source, Bool enable)</div><div class="ttdoc">Change the behavior of an initially configured external interrupt.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00164">AvrLib.c:164</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_abb586ce66a7472c329436a697b08afa7"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#abb586ce66a7472c329436a697b08afa7">Usart_Init</a></div><div class="ttdeci">void Usart_Init(uint32_t baudrate)</div><div class="ttdoc">initialize port D to use the uart</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00502">AvrLib.c:502</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_ac0999c0821d14cfab43e6f3c778c2b95"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#ac0999c0821d14cfab43e6f3c778c2b95">USART_RX_BUFFER_SIZE</a></div><div class="ttdeci">#define USART_RX_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00042">AvrLib.c:42</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_acb441b04bb3e49642c14dd9987538778"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#acb441b04bb3e49642c14dd9987538778">SetState</a></div><div class="ttdeci">void SetState(Fsm *fsm, StateHandler handler)</div><div class="ttdoc">Funktion für das Ausführen eine Zustandübergangs</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00353">AvrLib.c:353</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_acc879551df04aa1bcb4eadb27940e316"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#acc879551df04aa1bcb4eadb27940e316">UnregisterCompareMatchInterrupt</a></div><div class="ttdeci">void UnregisterCompareMatchInterrupt(CompareMatchSource source)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00217">AvrLib.c:217</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_acf0585ec1d8dfc68002eb0e357aec8ea"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#acf0585ec1d8dfc68002eb0e357aec8ea">RegisterFsm</a></div><div class="ttdeci">void RegisterFsm(Fsm *fsm)</div><div class="ttdoc">register a new finite state machine;</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00365">AvrLib.c:365</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_ad294b58ea2c279e31c0dde21101a5c83"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#ad294b58ea2c279e31c0dde21101a5c83">UnregisterExternalInterruptHandler</a></div><div class="ttdeci">void UnregisterExternalInterruptHandler(ExtInteruptSource source)</div><div class="ttdoc">Disable intterupts and unregister a previously registered handler.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00152">AvrLib.c:152</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_add0902722b85415d9271d54289b2af87"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#add0902722b85415d9271d54289b2af87">SendMessage</a></div><div class="ttdeci">void SendMessage(uint8_t prio, uint8_t id, uint8_t msgLow, uint8_t msgHigh)</div><div class="ttdoc">Put a message into the queue.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00418">AvrLib.c:418</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_ae906eb0b63f420e1d52ae1872339830c"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#ae906eb0b63f420e1d52ae1872339830c">GetElapsedTime</a></div><div class="ttdeci">uint32_t GetElapsedTime(void)</div><div class="ttdoc">Get the elapsed time since the last call to StartTimer.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00344">AvrLib.c:344</a></div></div>
<div class="ttc" id="a_avr_lib_8c_html_aff59557715efa0b5789b84418a503202"><div class="ttname"><a href="../../dc/d09/_avr_lib_8c.html#aff59557715efa0b5789b84418a503202">Usart_Trace3</a></div><div class="ttdeci">void Usart_Trace3(uint16_t id, uint8_t val1, uint8_t val2, uint8_t val3)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00734">AvrLib.c:734</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html">AvrLib.h</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a0ce138b43123a0eee6e73817fd7fdad6"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6">CompareMatchSource</a></div><div class="ttdeci">CompareMatchSource</div><div class="ttdoc">Enum identifying the supported compare match trigger sources.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00061">AvrLib.h:62</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a0ce138b43123a0eee6e73817fd7fdad6a5886f6fdffdc058e9880a7401dec13a5"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a5886f6fdffdc058e9880a7401dec13a5">CompareMatchSource1</a></div><div class="ttdeci">@ CompareMatchSource1</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00063">AvrLib.h:63</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a0ce138b43123a0eee6e73817fd7fdad6a97e301986802ebf575ba220fbceb2f69"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6a97e301986802ebf575ba220fbceb2f69">CompareMatchSource3</a></div><div class="ttdeci">@ CompareMatchSource3</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00065">AvrLib.h:65</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a0ce138b43123a0eee6e73817fd7fdad6aedd1e3f83271d3c1eb156e52c6ff3c10"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6aedd1e3f83271d3c1eb156e52c6ff3c10">CompareMatchSource4</a></div><div class="ttdeci">@ CompareMatchSource4</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00066">AvrLib.h:66</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a0ce138b43123a0eee6e73817fd7fdad6af01a0f3b78e977d18ca399618008ff76"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a0ce138b43123a0eee6e73817fd7fdad6af01a0f3b78e977d18ca399618008ff76">CompareMatchSource2</a></div><div class="ttdeci">@ CompareMatchSource2</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00064">AvrLib.h:64</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a13ddd1c9e6959d8921c2a03c25259c74"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a13ddd1c9e6959d8921c2a03c25259c74">StateHandler</a></div><div class="ttdeci">void(* StateHandler)(const Message *msg)</div><div class="ttdoc">Prototyp einer Zustandsfunktion.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00163">AvrLib.h:163</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a16e22dcfff49a475a1800ef74b7bc33aa9bb3a84ea7f3bc413a03a15cd5f68c7b"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a16e22dcfff49a475a1800ef74b7bc33aa9bb3a84ea7f3bc413a03a15cd5f68c7b">Priority_0</a></div><div class="ttdeci">@ Priority_0</div><div class="ttdoc">small numbers have low priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00086">AvrLib.h:86</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a39db6982619d623273fad8a383489309"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309">Bool</a></div><div class="ttdeci">Bool</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00025">AvrLib.h:26</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309a6d32c34708a0a3507c4bdb89219d650b">True</a></div><div class="ttdeci">@ True</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00029">AvrLib.h:28</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a39db6982619d623273fad8a383489309af9d46b7804d93a4fcde88489a1b68c24">False</a></div><div class="ttdeci">@ False</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00027">AvrLib.h:27</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4a9d6fbfc1595014e0074626b0688601"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601">ExtInteruptSource</a></div><div class="ttdeci">ExtInteruptSource</div><div class="ttdoc">enum describing the usable interrupt sources</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00037">AvrLib.h:38</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4a9d6fbfc1595014e0074626b0688601abe5535bcbfec4d06d24c2aa0b69ea604"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601abe5535bcbfec4d06d24c2aa0b69ea604">ExtInterruptSource0</a></div><div class="ttdeci">@ ExtInterruptSource0</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00039">AvrLib.h:39</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4a9d6fbfc1595014e0074626b0688601accf7dd3aeb8c08cb2c901cd3a9e29085"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4a9d6fbfc1595014e0074626b0688601accf7dd3aeb8c08cb2c901cd3a9e29085">ExtInterruptSource1</a></div><div class="ttdeci">@ ExtInterruptSource1</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00041">AvrLib.h:40</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4ae42ec4f888af04fb6287d24e90466aa2157e2cfa1ffb5844704bcb5c637bb81"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa2157e2cfa1ffb5844704bcb5c637bb81">PacketType_WriteRegister</a></div><div class="ttdeci">@ PacketType_WriteRegister</div><div class="ttdoc">write register command</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00112">AvrLib.h:112</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4ae42ec4f888af04fb6287d24e90466aa3b77c5f682b11fcb16bd520a1e05615f"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa3b77c5f682b11fcb16bd520a1e05615f">PacketType_TraceMassagePadLen</a></div><div class="ttdeci">@ PacketType_TraceMassagePadLen</div><div class="ttdoc">The unused of this value hold the length of a trace message.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00113">AvrLib.h:113</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4ae42ec4f888af04fb6287d24e90466aa7661b2c4df7f44ff4d4d0cd2c701cc52"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa7661b2c4df7f44ff4d4d0cd2c701cc52">PacketType_ReadRegister</a></div><div class="ttdeci">@ PacketType_ReadRegister</div><div class="ttdoc">read register command</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00111">AvrLib.h:111</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4ae42ec4f888af04fb6287d24e90466aa82dcf9244c49b9d3de690d58987a5ef2"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4ae42ec4f888af04fb6287d24e90466aa82dcf9244c49b9d3de690d58987a5ef2">PacketType_TraceMessage</a></div><div class="ttdeci">@ PacketType_TraceMessage</div><div class="ttdoc">a trace message is sent from the board to the PC</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00114">AvrLib.h:114</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a4c0d7aa7c14c0567c522c664cd4e0b42"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a4c0d7aa7c14c0567c522c664cd4e0b42">ExtIntTrigger</a></div><div class="ttdeci">ExtIntTrigger</div><div class="ttdoc">enum describing the trigger events on the interrupt sources.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00047">AvrLib.h:48</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a70c39f26249a6aa73d608f47e34fe346"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a70c39f26249a6aa73d608f47e34fe346">IsrHandler</a></div><div class="ttdeci">void(* IsrHandler)(void)</div><div class="ttdoc">Prototyp einer InterruptServiceRoutine.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00158">AvrLib.h:158</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_a7b883ddec9db2ef9aff1d336b0b4be3b"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#a7b883ddec9db2ef9aff1d336b0b4be3b">AvrMessageHandler</a></div><div class="ttdeci">Bool(* AvrMessageHandler)(const AvrMessage *msg)</div><div class="ttdoc">Prototyp eines AvrPacketHandlers.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00168">AvrLib.h:168</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_aa3faf8a487b0f96253c1f91b127fe692"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#aa3faf8a487b0f96253c1f91b127fe692">TimerFrequency</a></div><div class="ttdeci">TimerFrequency</div><div class="ttdoc">enum describing the timer divisions supported by the function RegisterCompareMatchInterrupt()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00074">AvrLib.h:75</a></div></div>
<div class="ttc" id="a_avr_lib_8h_html_ab317c73e51fb8a68f86165ac831f7b8c"><div class="ttname"><a href="../../d9/dcd/_avr_lib_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a></div><div class="ttdeci">#define countof(array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00017">AvrLib.h:17</a></div></div>
<div class="ttc" id="a_register_access_8h_html"><div class="ttname"><a href="../../d2/d7f/_register_access_8h.html">RegisterAccess.h</a></div></div>
<div class="ttc" id="a_register_access_8h_html_aae46f7142feaa5f8637cf3918b91201b"><div class="ttname"><a href="../../d2/d7f/_register_access_8h.html#aae46f7142feaa5f8637cf3918b91201b">UpdateRegister</a></div><div class="ttdeci">#define UpdateRegister(reg,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7f/_register_access_8h_source.html#l00054">RegisterAccess.h:54</a></div></div>
<div class="ttc" id="a_register_access_8h_html_af8f11a685f46bcd86b727c651674209d"><div class="ttname"><a href="../../d2/d7f/_register_access_8h.html#af8f11a685f46bcd86b727c651674209d">SetRegister</a></div><div class="ttdeci">#define SetRegister(reg,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7f/_register_access_8h_source.html#l00051">RegisterAccess.h:51</a></div></div>
<div class="ttc" id="astruct_avr_message__tag_html"><div class="ttname"><a href="../../d5/d8e/struct_avr_message__tag.html">AvrMessage_tag</a></div><div class="ttdoc">Genreic structure of a data packate that is used to exchange data between PC and Board.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00122">AvrLib.h:123</a></div></div>
<div class="ttc" id="astruct_avr_message__tag_html_a1cc06e7e3b464d0772fc8f28320101bd"><div class="ttname"><a href="../../d5/d8e/struct_avr_message__tag.html#a1cc06e7e3b464d0772fc8f28320101bd">AvrMessage_tag::MsgType</a></div><div class="ttdeci">AvrPacketType MsgType</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00124">AvrLib.h:124</a></div></div>
<div class="ttc" id="astruct_avr_message__tag_html_a2b1ba85fe7425ab62c629e2d39646b24"><div class="ttname"><a href="../../d5/d8e/struct_avr_message__tag.html#a2b1ba85fe7425ab62c629e2d39646b24">AvrMessage_tag::Length</a></div><div class="ttdeci">uint8_t Length</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00125">AvrLib.h:125</a></div></div>
<div class="ttc" id="astruct_avr_message__tag_html_aec2f4e71f5d2fe9ecae681a068e987e3"><div class="ttname"><a href="../../d5/d8e/struct_avr_message__tag.html#aec2f4e71f5d2fe9ecae681a068e987e3">AvrMessage_tag::Payload</a></div><div class="ttdeci">uint8_t Payload[12]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00126">AvrLib.h:126</a></div></div>
<div class="ttc" id="astruct_cmd_read_reg_html"><div class="ttname"><a href="../../d0/d70/struct_cmd_read_reg.html">CmdReadReg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00072">AvrLib.c:73</a></div></div>
<div class="ttc" id="astruct_cmd_read_reg_html_a2bbf395c8735fe93e11fcae33c3ac482"><div class="ttname"><a href="../../d0/d70/struct_cmd_read_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">CmdReadReg::adress</a></div><div class="ttdeci">uint16_t adress</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00074">AvrLib.c:74</a></div></div>
<div class="ttc" id="astruct_cmd_read_reg_html_a5723e60ffd628510c699eddbce90be23"><div class="ttname"><a href="../../d0/d70/struct_cmd_read_reg.html#a5723e60ffd628510c699eddbce90be23">CmdReadReg::len</a></div><div class="ttdeci">uint8_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00075">AvrLib.c:75</a></div></div>
<div class="ttc" id="astruct_cmd_write_reg_html"><div class="ttname"><a href="../../dd/d22/struct_cmd_write_reg.html">CmdWriteReg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00061">AvrLib.c:62</a></div></div>
<div class="ttc" id="astruct_cmd_write_reg_html_a2bbf395c8735fe93e11fcae33c3ac482"><div class="ttname"><a href="../../dd/d22/struct_cmd_write_reg.html#a2bbf395c8735fe93e11fcae33c3ac482">CmdWriteReg::adress</a></div><div class="ttdeci">uint16_t adress</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00063">AvrLib.c:63</a></div></div>
<div class="ttc" id="astruct_cmd_write_reg_html_a5723e60ffd628510c699eddbce90be23"><div class="ttname"><a href="../../dd/d22/struct_cmd_write_reg.html#a5723e60ffd628510c699eddbce90be23">CmdWriteReg::len</a></div><div class="ttdeci">uint8_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00064">AvrLib.c:64</a></div></div>
<div class="ttc" id="astruct_cmd_write_reg_html_a582f3f7dde5c677ef7b3c6fc7d27beb4"><div class="ttname"><a href="../../dd/d22/struct_cmd_write_reg.html#a582f3f7dde5c677ef7b3c6fc7d27beb4">CmdWriteReg::data</a></div><div class="ttdeci">union CmdWriteReg::@0 data</div></div>
<div class="ttc" id="astruct_cmd_write_reg_html_a96f44d20f1dbf1c8785a7bc99a46164c"><div class="ttname"><a href="../../dd/d22/struct_cmd_write_reg.html#a96f44d20f1dbf1c8785a7bc99a46164c">CmdWriteReg::byte</a></div><div class="ttdeci">uint8_t byte</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00067">AvrLib.c:67</a></div></div>
<div class="ttc" id="astruct_cmd_write_reg_html_af9036114e498c9fcb670232e4227341a"><div class="ttname"><a href="../../dd/d22/struct_cmd_write_reg.html#af9036114e498c9fcb670232e4227341a">CmdWriteReg::word</a></div><div class="ttdeci">uint16_t word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d09/_avr_lib_8c_source.html#l00068">AvrLib.c:68</a></div></div>
<div class="ttc" id="astruct_fsm__tag_html"><div class="ttname"><a href="../../df/d89/struct_fsm__tag.html">Fsm_tag</a></div><div class="ttdoc">Repräsentiert eine Zustandsmaschine.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00177">AvrLib.h:178</a></div></div>
<div class="ttc" id="astruct_fsm__tag_html_a60c28f55103a33bcb3962fc3c5c3108d"><div class="ttname"><a href="../../df/d89/struct_fsm__tag.html#a60c28f55103a33bcb3962fc3c5c3108d">Fsm_tag::CurrentState</a></div><div class="ttdeci">StateHandler CurrentState</div><div class="ttdoc">Funktion, welche den aktuellen Zustand representiert.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00181">AvrLib.h:181</a></div></div>
<div class="ttc" id="astruct_fsm__tag_html_a7eb70411183a2bad1636f49893c8af52"><div class="ttname"><a href="../../df/d89/struct_fsm__tag.html#a7eb70411183a2bad1636f49893c8af52">Fsm_tag::Next</a></div><div class="ttdeci">struct Fsm_tag * Next</div><div class="ttdoc">nächste registrierte Zustanndsmaschine; internal use only!</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00179">AvrLib.h:179</a></div></div>
<div class="ttc" id="astruct_fsm__tag_html_ab7668ff9f0f7f2a6cb9ed24f7f0a905b"><div class="ttname"><a href="../../df/d89/struct_fsm__tag.html#ab7668ff9f0f7f2a6cb9ed24f7f0a905b">Fsm_tag::RxMask</a></div><div class="ttdeci">uint8_t RxMask</div><div class="ttdoc">Maske, welche angibt, welche Prioritäyten bearbeitet werden sollen.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00180">AvrLib.h:180</a></div></div>
<div class="ttc" id="astruct_message__tag_html"><div class="ttname"><a href="../../d3/d6f/struct_message__tag.html">Message_tag</a></div><div class="ttdoc">Item um Information zwischen verschiedenen Komponenten des Systems auszutauschen.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00135">AvrLib.h:136</a></div></div>
<div class="ttc" id="astruct_message__tag_html_a2e0462cee9727c48ffba3fe0d02e6395"><div class="ttname"><a href="../../d3/d6f/struct_message__tag.html#a2e0462cee9727c48ffba3fe0d02e6395">Message_tag::Priority</a></div><div class="ttdeci">uint8_t Priority</div><div class="ttdoc">Definiert die Priorität; je kleiner die Zahl, desto grösser die Priorität; Es sind vier Prioritäten d...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00137">AvrLib.h:137</a></div></div>
<div class="ttc" id="astruct_message__tag_html_aaafeafacfe3dadc5541605cc0da13c35"><div class="ttname"><a href="../../d3/d6f/struct_message__tag.html#aaafeafacfe3dadc5541605cc0da13c35">Message_tag::MsgParamLow</a></div><div class="ttdeci">uint8_t MsgParamLow</div><div class="ttdoc">lower byte[0] des Meldungs-Parameters</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00144">AvrLib.h:144</a></div></div>
<div class="ttc" id="astruct_message__tag_html_ab56be972df2ad47daaf93202b389d4c2"><div class="ttname"><a href="../../d3/d6f/struct_message__tag.html#ab56be972df2ad47daaf93202b389d4c2">Message_tag::__next</a></div><div class="ttdeci">struct Message_tag * __next</div><div class="ttdoc">element with next priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00149">AvrLib.h:149</a></div></div>
<div class="ttc" id="astruct_message__tag_html_abaeb5d499fed378ac6832d36de77bbdf"><div class="ttname"><a href="../../d3/d6f/struct_message__tag.html#abaeb5d499fed378ac6832d36de77bbdf">Message_tag::Id</a></div><div class="ttdeci">uint8_t Id</div><div class="ttdoc">Id der Meldung.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00139">AvrLib.h:139</a></div></div>
<div class="ttc" id="astruct_message__tag_html_ac151a25233807367672981a8d3affccd"><div class="ttname"><a href="../../d3/d6f/struct_message__tag.html#ac151a25233807367672981a8d3affccd">Message_tag::MsgParamHigh</a></div><div class="ttdeci">uint8_t MsgParamHigh</div><div class="ttdoc">upper byte[1] des Meldungs-Paramsters</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dcd/_avr_lib_8h_source.html#l00145">AvrLib.h:145</a></div></div>
<div class="ttc" id="astruct_t_c_n_t8___t__tag_html"><div class="ttname"><a href="../../d9/d52/struct_t_c_n_t8___t__tag.html">TCNT8_T_tag</a></div><div class="ttdoc">8 bit timer counter with PWM</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00276">Atmega328P.h:277</a></div></div>
<div class="ttc" id="astruct_t_c_n_t8___t__tag_html_a12a1aed38add959821a44e6b9709c9e2"><div class="ttname"><a href="../../d9/d52/struct_t_c_n_t8___t__tag.html#a12a1aed38add959821a44e6b9709c9e2">TCNT8_T_tag::TCCRB</a></div><div class="ttdeci">volatile uint8_t TCCRB</div><div class="ttdoc">Configuration Register 2; Operation mode and counting speed.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00279">Atmega328P.h:279</a></div></div>
<div class="ttc" id="astruct_t_c_n_t8___t__tag_html_a180b96b3caee3b8f245ac6a37d8e8306"><div class="ttname"><a href="../../d9/d52/struct_t_c_n_t8___t__tag.html#a180b96b3caee3b8f245ac6a37d8e8306">TCNT8_T_tag::OCRA</a></div><div class="ttdeci">volatile uint8_t OCRA</div><div class="ttdoc">Compare value A.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00281">Atmega328P.h:281</a></div></div>
<div class="ttc" id="astruct_t_c_n_t8___t__tag_html_ae1ae3b1526dbf378e2e6359e5169285e"><div class="ttname"><a href="../../d9/d52/struct_t_c_n_t8___t__tag.html#ae1ae3b1526dbf378e2e6359e5169285e">TCNT8_T_tag::TCCRA</a></div><div class="ttdeci">volatile uint8_t TCCRA</div><div class="ttdoc">Configuration register 1; Operation mode.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/_atmega328_p_8h_source.html#l00278">Atmega328P.h:278</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_905d5e0adf22be5609dc10728e072493.html">AvrLib</a></li><li class="navelem"><a class="el" href="../../dc/d09/_avr_lib_8c.html">AvrLib.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0 </li>
  </ul>
</div>
</body>
</html>
